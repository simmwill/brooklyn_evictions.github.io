<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Project Report</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="https://nk2814.shinyapps.io/evictions_spaghetti_shiny/">Evictions Over Time</a>
</li>
<li>
  <a href="question_2.html">Filings vs. Evictions</a>
</li>
<li>
  <a href="question_3_maps.html">What Predicts Eviction Rates?</a>
</li>
<li>
  <a href="model_building.html">Model Building</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://willsimmons.shinyapps.io/model_building/">Interactive Model</a>
</li>
<li>
  <a href="conclusions.html">Conclusions</a>
</li>
<li>
  <a href="overview.html">Report</a>
</li>
<li>
  <a href="https://github.com/simmwill/evictions">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Project Report</h1>

</div>


<style type="text/css">

h1.title {
  text-align: center;
}

</style>
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<ul>
<li>Healthy People 2020 identified housing instability as a key issue in addressing social determinants of health in the United States.</li>
<li>Evictions are an important element of housing instability, and approximately 2 million tenants were evicted nationwide in 2016.</li>
<li>Evictions and eviction filings disproportionately affect low-income and minority residents, perpetuating cycles of poverty and instability.</li>
<li>Discriminatory practices in evictions and eviction filings exist, and need to be better understood and addressed.</li>
</ul>
</div>
<div id="questions" class="section level2">
<h2>Questions</h2>
<ul>
<li>How have eviction rates changed over time by census tract in Brooklyn?</li>
<li>Are there spatial patterns in the discrepancy between eviction filings and evictions at the neighborhood level? Do these patterns reflect distributions of other key variables of interest?</li>
<li>What factors are associated with eviction rates across census tract in Brooklyn?</li>
</ul>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<div id="sources-and-variables-of-interest" class="section level4">
<h4><em>Sources and variables of interest</em></h4>
<ul>
<li><p>Primary data source: <a href="https://evictionlab.org/">Eviction Lab</a></p></li>
<li><p>For gentrification measures: <a href="https://www.urbandisplacement.org/maps/ny">Mapping Displacement and Gentrification in the New York Metropolitan Area (Urban Displacement Project)</a> ^ Are we still using this?</p></li>
<li><p>For English language usage and population density: <a href="https://factfinder.census.gov/faces/nav/jsf/pages/guided_search.xhtml">American FactFinder</a></p></li>
<li><p>Supplemental data source: <a href="https://www1.nyc.gov/site/planning/data-maps/open-data/dwn-nynta.page">NYC Open Data</a></p></li>
</ul>
<p>Include links to shapefiles?</p>
</div>
<div id="cleaning" class="section level4">
<h4><em>Cleaning</em></h4>
<p>After choosing to focus on New York City, data were limited to Brooklyn as this was the only borough with complete data for 2016 and also all time points from 2000 to 2016. Datasets were merged using the 11-digit FIPs code, <code>geoid</code>. Population density was calculated by dividing the number of people living in each census tract by the square miles of each census tract per year.</p>
<p>English language usage data and percent non-white data were only available for 2010-2016. Variables for these data were extracted from ACS data and created for each year.</p>
<p>We then imported eviction data, which included eviction rates and other relevant metrics by census tract.</p>
<pre class="r"><code># CSV file contains all census tracts for NY state, so we&#39;ll import the file and then filter such that the dataframe &#39;eviction&#39; only contains NYC census tracts.

# contains years 2000 - 2016
# n = 1880 per year (1880 census tracts)


eviction = 
  read.csv(&#39;./data/EvictionData_NY.csv&#39;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(parent_location %in% c(&quot;New York County, New York&quot;, &quot;Queens County, New York&quot;, &quot;Kings County, New York&quot;, &quot;Bronx County, New York&quot;, &quot;Richmond County, New York&quot;),
         year %in% c(2010:2016),
         population != 0) %&gt;% 
  
  ## selecting and renaming variables
  mutate(pct_nonwhite = (100 - pct_white),
         geoid = as.character(geoid),
         year = as.ordered(year)) %&gt;% 
  select(geoid, year, ## contextual
         evictions, eviction_filings, eviction_rate, eviction_filing_rate, renter_occupied_households, ## outcomes
         pct_nonwhite_evictiondata = pct_nonwhite, ## hypothesized predictors
         poverty_rate, rent_burden, pct_af_am, pct_renter_occupied, median_gross_rent, median_household_income, median_property_value) %&gt;% ## other predictors
  filter(renter_occupied_households &gt; 10) # census tracts with few renter households were creating eviction rates of 150, 200, etc.

## note: eviction filing rate calculated (# evictions / # renter occupied households)</code></pre>
<p>To look at neighborhood-level data, sample weights were calculated by dividing the population of the census tract by the population of the neighborhood. These weights were then applied to all variables of interest to calculate aggregate measures by neighborhood.</p>
<pre class="r"><code>neighborhood_data_prep = eviction_data %&gt;% 
  group_by(neighborhood) %&gt;% 
  mutate(
    neighb_pop = sum(population),
    tract_weight = population/neighb_pop,
    eviction_discrepancy = eviction_filing_rate - eviction_rate,
    weighted_eviction_discrep = eviction_discrepancy*tract_weight,
    weighted_eviction_rate = eviction_rate*tract_weight,
    pct_nonwhite = 100 - pct_white,
    weighted_pct_nonwhite = pct_nonwhite*tract_weight,
    weighted_povertyrate = poverty_rate*tract_weight)

neighborhood_data = neighborhood_data_prep %&gt;% 
  summarize(
    wt_eviction_rate = round(as.numeric(sum(weighted_eviction_rate)), digits = 2),
    wt_eviction_rate_discrep = round(sum(weighted_eviction_discrep), digits = 2),
    wt_pct_nonwhite = sum(weighted_pct_nonwhite),
    wt_povertyrate = sum(weighted_povertyrate)) %&gt;% 
  ungroup() %&gt;% 
  mutate(neighborhood = as.factor(neighborhood))</code></pre>
<p>Population density data</p>
<pre class="r"><code>## For the ACS data, we&#39;ll have to use a crude measure of population density we calculate ourselves - census tract population (which changes every year) divided by census tract area (which does not usually change). 

## NUMERATOR
## Importing population per census tract per year
filenames_DP05 = 
  list.files(&#39;./data/&#39;) %&gt;%
  paste0(&#39;./data/&#39;, .) %&gt;% 
  as_tibble() %&gt;% 
  filter(str_detect(value, &#39;DP05&#39;)) %&gt;% 
  pull(., value) ## coerces tibble back to vector for reading by map_df()

population_data = 
  map_dfr(filenames_DP05, read_csv, .id = &quot;input&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  select(id = geo_id, id2 = geo_id2, geography = geo_display_label, total_pop = hc01_vc03, year = input) %&gt;% 
  filter(id != &quot;Id&quot;) %&gt;% 
  mutate(id2 = as.numeric(id2),
         year = as.numeric(year) + 2009,
         name = as.character(readr::parse_number(geography)),
         geography = str_remove(geography, &quot;Census Tract [0-9]{1,}, &quot;),
         geography = str_remove(geography, &quot;Census Tract [0-9]{1,}\\.[0-9]{1,}, &quot;),
         total_pop = as.numeric(total_pop)) %&gt;% 
  select(id, id2, name, geography, total_pop, year) %&gt;% 
  filter(total_pop != 0)

## DENOMINATOR
## Importing area in sq. mi. for each area:
area = 
  read_csv(&#39;./data/ACS_09_5YR_G001_with_ann.csv&#39;, skip = 1) %&gt;% 
  janitor::clean_names() %&gt;% 
  select(id, id2, geography, area_sqmi = land_area_in_square_miles) %&gt;% 
  mutate(name = as.character(readr::parse_number(geography)),
         geography = str_remove(geography, &quot;Census Tract [0-9]{1,}, &quot;),
         geography = str_remove(geography, &quot;Census Tract [0-9]{1,}\\.[0-9]{1,}, &quot;)) %&gt;% 
  select(id2, area_sqmi)

## JOINING DATASETS &amp; CALCULATING DENSITY
density_data =
  left_join(population_data, area, by = &quot;id2&quot;) %&gt;% 
  mutate(density = total_pop / area_sqmi,
         id2 = as.character(id2),
         year = as.ordered(year)) %&gt;% 

  ## selecting and renaming meaningful variables

  filter(geography %in% c(&quot;New York County, New York&quot;, &quot;Queens County, New York&quot;, &quot;Kings County, New York&quot;, &quot;Bronx County, New York&quot;, &quot;Richmond County, New York&quot;),
       year %in% c(2010:2016)) %&gt;% 
  select(geoid = id2, year, total_pop_densitydata = total_pop, area_sqmi, density)</code></pre>
<p>ESL data (note that function was not practical, since variable name changed unpredictably across datasets)</p>
<pre class="r"><code>## English language usage data- we import data from 2010-2016
## Relevant variable (the percentage of the population 5 and over that speaks English less than &quot;very well&quot;), changes by year- files are therefore individually imported

englang_2010 = 
  read.csv(&quot;./data/ACS_10_5YR_DP02_with_ann.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  mutate(year = &quot;2010&quot;, geo_id = as.character(geo_id), geo_id2 = as.character(geo_id2)) %&gt;%
  select(year, geo_id, geo_id2, hc03_vc170, hc03_vc04, hc01_vc21) %&gt;% ## percent family households and avg family size
  filter(geo_id != &quot;Id&quot;) %&gt;%
  mutate(pct_eng = as.numeric(as.character(hc03_vc170)),
         pct_fam_households = as.numeric(as.character(hc03_vc04)),
         family_size = as.numeric(as.character(hc01_vc21))) %&gt;%
  select(-hc03_vc170, -hc03_vc04, -hc01_vc21)

englang_2011 = 
  read.csv(&quot;./data/ACS_11_5YR_DP02_with_ann.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  mutate(year = &quot;2011&quot;, geo_id = as.character(geo_id), geo_id2 = as.character(geo_id2)) %&gt;%
  select(year, geo_id, geo_id2, hc03_vc170, hc03_vc04, hc01_vc21) %&gt;% ## percent family households and avg family size
  filter(geo_id != &quot;Id&quot;) %&gt;%
  mutate(pct_eng = as.numeric(as.character(hc03_vc170)),
         pct_fam_households = as.numeric(as.character(hc03_vc04)),
         family_size = as.numeric(as.character(hc01_vc21))) %&gt;%
  select(-hc03_vc170, -hc03_vc04, -hc01_vc21)

englang_2012 = 
  read.csv(&quot;./data/ACS_12_5YR_DP02_with_ann.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  mutate(year = &quot;2012&quot;, geo_id = as.character(geo_id), geo_id2 = as.character(geo_id2)) %&gt;%
  select(year, geo_id, geo_id2, hc03_vc170, hc03_vc04, hc01_vc21) %&gt;% ## percent family households and avg family size
  filter(geo_id != &quot;Id&quot;) %&gt;%
  mutate(pct_eng = as.numeric(as.character(hc03_vc170)),
         pct_fam_households = as.numeric(as.character(hc03_vc04)),
         family_size = as.numeric(as.character(hc01_vc21))) %&gt;%
  select(-hc03_vc170, -hc03_vc04, -hc01_vc21)

englang_2013 = 
  read.csv(&quot;./data/ACS_13_5YR_DP02_with_ann.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  mutate(year = &quot;2013&quot;, geo_id = as.character(geo_id), geo_id2 = as.character(geo_id2)) %&gt;%
  select(year, geo_id, geo_id2, hc03_vc170, hc03_vc04, hc01_vc21) %&gt;% ## percent family households and avg family size
  filter(geo_id != &quot;Id&quot;) %&gt;%
  mutate(pct_eng = as.numeric(as.character(hc03_vc170)),
         pct_fam_households = as.numeric(as.character(hc03_vc04)),
         family_size = as.numeric(as.character(hc01_vc21))) %&gt;%
  select(-hc03_vc170, -hc03_vc04, -hc01_vc21)

englang_2014 = 
  read.csv(&quot;./data/ACS_14_5YR_DP02_with_ann.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  mutate(year = &quot;2014&quot;, geo_id = as.character(geo_id), geo_id2 = as.character(geo_id2)) %&gt;%
  select(year, geo_id, geo_id2, hc03_vc170, hc03_vc04, hc01_vc22) %&gt;% ## percent family households and avg family size
  filter(geo_id != &quot;Id&quot;) %&gt;%
  mutate(pct_eng = as.numeric(as.character(hc03_vc170)),
         pct_fam_households = as.numeric(as.character(hc03_vc04)),
         family_size = as.numeric(as.character(hc01_vc22))) %&gt;%
  select(-hc03_vc170, -hc03_vc04, -hc01_vc22)

englang_2015 = 
  read.csv(&quot;./data/ACS_15_5YR_DP02_with_ann.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  mutate(year = &quot;2015&quot;, geo_id = as.character(geo_id), geo_id2 = as.character(geo_id2)) %&gt;%
  select(year, geo_id, geo_id2, hc03_vc170, hc03_vc04, hc01_vc22) %&gt;% ## percent family households and avg family size
  filter(geo_id != &quot;Id&quot;) %&gt;%
  mutate(pct_eng = as.numeric(as.character(hc03_vc170)),
         pct_fam_households = as.numeric(as.character(hc03_vc04)),
         family_size = as.numeric(as.character(hc01_vc22))) %&gt;%
  select(-hc03_vc170, -hc03_vc04, -hc01_vc22)

englang_2016 = 
  read.csv(&quot;./data/ACS_16_5YR_DP02_with_ann.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  mutate(year = &quot;2016&quot;, geo_id = as.character(geo_id), geo_id2 = as.character(geo_id2)) %&gt;%
  select(year, geo_id, geo_id2, hc03_vc170, hc03_vc04, hc01_vc22) %&gt;% ## percent family households and avg family size
  filter(geo_id != &quot;Id&quot;) %&gt;%
  mutate(pct_eng = as.numeric(as.character(hc03_vc170)),
         pct_fam_households = as.numeric(as.character(hc03_vc04)),
         family_size = as.numeric(as.character(hc01_vc22))) %&gt;%
  select(-hc03_vc170, -hc03_vc04, -hc01_vc22)

englang_data = 
  bind_rows(englang_2010, englang_2011, englang_2012, englang_2013, englang_2014, englang_2015, englang_2016) %&gt;% 
  mutate(geo_id2 = as.character(geo_id2),
         year = as.ordered(year)) %&gt;% 
  
  ## restricting and renaming etc.
  select(geoid = geo_id2, year, pct_eng, family_size, pct_fam_households) %&gt;% 
  
  ## bronx, kings, new york, queens, richmond counties - using codes (need to triple-check these match up with County Names)
  filter(substr(geoid, 1,5) %in% c(36005, 36047, 36061, 36081, 36085),
         year %in% c(2010:2016))</code></pre>
<p>Race data (same caveat as above)</p>
<pre class="r"><code>## Racial composition data- we import data from 2010-2016
## Racial categories are not mutually exclusive, so total percentages may sum to more than 100%
## Relevant variable (the percentage of the population 5 and over that speaks English less than &quot;very well&quot;), changes by year- files are therefore individually imported

race_2010 = 
  read.csv(&quot;./data/ACS_10_5YR_DP05_with_ann.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  mutate(year = &quot;2010&quot;, geo_id = as.character(geo_id), geo_id2 = as.character(geo_id2)) %&gt;%
  select(year, geo_id, geo_id2, hc03_vc72, hc03_vc73, hc03_vc74, hc03_vc75, hc03_vc76, hc03_vc77, hc03_vc82) %&gt;%
  filter(geo_id != &quot;Id&quot;) %&gt;%
  rename(white = hc03_vc72, black = hc03_vc73, aian = hc03_vc74, asian = hc03_vc75, nhpi = hc03_vc76, other = hc03_vc77, hisp = hc03_vc82
) %&gt;%
  mutate(
    white = as.numeric(as.character(white)),
    black = as.numeric(as.character(black)),
    aian = as.numeric(as.character(aian)),
    asian = as.numeric(as.character(asian)),
    nhpi = as.numeric(as.character(nhpi)),
    other = as.numeric(as.character(other)),
    hisp = as.numeric(as.character(hisp))
  )

race_2011 = 
  read.csv(&quot;./data/ACS_11_5YR_DP05_with_ann.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  mutate(year = &quot;2011&quot;, geo_id = as.character(geo_id), geo_id2 = as.character(geo_id2)) %&gt;%
  select(year, geo_id, geo_id2, hc03_vc72, hc03_vc73, hc03_vc74, hc03_vc75, hc03_vc76, hc03_vc77, hc03_vc82) %&gt;%
  filter(geo_id != &quot;Id&quot;) %&gt;%
  rename(white = hc03_vc72, black = hc03_vc73, aian = hc03_vc74, asian = hc03_vc75, nhpi = hc03_vc76, other = hc03_vc77, hisp = hc03_vc82) %&gt;%
  mutate(
    white = as.numeric(as.character(white)),
    black = as.numeric(as.character(black)),
    aian = as.numeric(as.character(aian)),
    asian = as.numeric(as.character(asian)),
    nhpi = as.numeric(as.character(nhpi)),
    other = as.numeric(as.character(other)),
    hisp = as.numeric(as.character(hisp))
  )

race_2012 = 
  read.csv(&quot;./data/ACS_12_5YR_DP05_with_ann.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  mutate(year = &quot;2012&quot;, geo_id = as.character(geo_id), geo_id2 = as.character(geo_id2)) %&gt;%
  select(year, geo_id, geo_id2, hc03_vc72, hc03_vc73, hc03_vc74, hc03_vc75, hc03_vc76, hc03_vc77, hc03_vc82) %&gt;%
  filter(geo_id != &quot;Id&quot;) %&gt;%
  rename(white = hc03_vc72, black = hc03_vc73, aian = hc03_vc74, asian = hc03_vc75, nhpi = hc03_vc76, other = hc03_vc77, hisp = hc03_vc82) %&gt;%
  mutate(
    white = as.numeric(as.character(white)),
    black = as.numeric(as.character(black)),
    aian = as.numeric(as.character(aian)),
    asian = as.numeric(as.character(asian)),
    nhpi = as.numeric(as.character(nhpi)),
    other = as.numeric(as.character(other)),
    hisp = as.numeric(as.character(hisp))
  )

race_2013 = 
  read.csv(&quot;./data/ACS_13_5YR_DP05_with_ann.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  mutate(year = &quot;2013&quot;, geo_id = as.character(geo_id), geo_id2 = as.character(geo_id2)) %&gt;%
  select(year, geo_id, geo_id2, hc03_vc78, hc03_vc79, hc03_vc80, hc03_vc81, hc03_vc82, hc03_vc83, hc03_vc88) %&gt;%
  filter(geo_id != &quot;Id&quot;) %&gt;%
  rename(white = hc03_vc78, black = hc03_vc79, aian = hc03_vc80, asian = hc03_vc81, nhpi = hc03_vc82, other = hc03_vc83, hisp = hc03_vc88) %&gt;%
  mutate(
    white = as.numeric(as.character(white)),
    black = as.numeric(as.character(black)),
    aian = as.numeric(as.character(aian)),
    asian = as.numeric(as.character(asian)),
    nhpi = as.numeric(as.character(nhpi)),
    other = as.numeric(as.character(other)),
    hisp = as.numeric(as.character(hisp))
  )

race_2014 = 
  read.csv(&quot;./data/ACS_14_5YR_DP05_with_ann.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  mutate(year = &quot;2014&quot;, geo_id = as.character(geo_id), geo_id2 = as.character(geo_id2)) %&gt;%
  select(year, geo_id, geo_id2, hc03_vc78, hc03_vc79, hc03_vc80, hc03_vc81, hc03_vc82, hc03_vc83, hc03_vc88) %&gt;%
  filter(geo_id != &quot;Id&quot;) %&gt;%
  rename(white = hc03_vc78, black = hc03_vc79, aian = hc03_vc80, asian = hc03_vc81, nhpi = hc03_vc82, other = hc03_vc83, hisp = hc03_vc88) %&gt;%
  mutate(
    white = as.numeric(as.character(white)),
    black = as.numeric(as.character(black)),
    aian = as.numeric(as.character(aian)),
    asian = as.numeric(as.character(asian)),
    nhpi = as.numeric(as.character(nhpi)),
    other = as.numeric(as.character(other)),
    hisp = as.numeric(as.character(hisp))
  )

race_2015 = 
  read.csv(&quot;./data/ACS_15_5YR_DP05_with_ann.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  mutate(year = &quot;2015&quot;, geo_id = as.character(geo_id), geo_id2 = as.character(geo_id2)) %&gt;%
  select(year, geo_id, geo_id2, hc03_vc78, hc03_vc79, hc03_vc80, hc03_vc81, hc03_vc82, hc03_vc83, hc03_vc88) %&gt;%
  filter(geo_id != &quot;Id&quot;) %&gt;%
  rename(white = hc03_vc78, black = hc03_vc79, aian = hc03_vc80, asian = hc03_vc81, nhpi = hc03_vc82, other = hc03_vc83, hisp = hc03_vc88) %&gt;%
  mutate(
    white = as.numeric(as.character(white)),
    black = as.numeric(as.character(black)),
    aian = as.numeric(as.character(aian)),
    asian = as.numeric(as.character(asian)),
    nhpi = as.numeric(as.character(nhpi)),
    other = as.numeric(as.character(other)),
    hisp = as.numeric(as.character(hisp))
  )

race_2016 = 
  read.csv(&quot;./data/ACS_16_5YR_DP05_with_ann.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  mutate(year = &quot;2016&quot;, geo_id = as.character(geo_id), geo_id2 = as.character(geo_id2)) %&gt;%
  select(year, geo_id, geo_id2, hc03_vc78, hc03_vc79, hc03_vc80, hc03_vc81, hc03_vc82, hc03_vc83, hc03_vc88) %&gt;% ## ADDED HISPANIC
  filter(geo_id != &quot;Id&quot;) %&gt;%
  rename(white = hc03_vc78, black = hc03_vc79, aian = hc03_vc80, asian = hc03_vc81, nhpi = hc03_vc82, other = hc03_vc83, hisp = hc03_vc88) %&gt;%
  mutate(
    white = as.numeric(as.character(white)),
    black = as.numeric(as.character(black)),
    aian = as.numeric(as.character(aian)),
    asian = as.numeric(as.character(asian)),
    nhpi = as.numeric(as.character(nhpi)),
    other = as.numeric(as.character(other)),
    hisp = as.numeric(as.character(hisp))
  )

race_data = 
  bind_rows(race_2010, race_2011, race_2012, race_2013, race_2014, race_2015, race_2016) %&gt;% 
  
  ## creating % nonwhite
  mutate(pct_nonwhite_racedata = (100 - white),
         geo_id2 = as.character(geo_id2),
         year = as.ordered(year)) %&gt;% 
  rename(geoid = geo_id2) %&gt;% 
  
  ## bronx, kings, new york, queens, richmond counties - using codes (need to triple-check these match up with County Names)
  filter(substr(geoid, 1,5) %in% c(36005, 36047, 36061, 36081, 36085),
         year %in% c(2010:2016)) %&gt;% 
  
  ## restricting and renaming etc.
  select(-geo_id)</code></pre>
<p>Creating key to transform <code>geoid</code> to boro</p>
<pre class="r"><code>## creating key for geoid &lt;--&gt; boro
geoid_boro_key = 
  read.csv(&#39;./data/EvictionData_NY.csv&#39;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(parent_location %in% c(&quot;New York County, New York&quot;, &quot;Queens County, New York&quot;, &quot;Kings County, New York&quot;, &quot;Bronx County, New York&quot;, &quot;Richmond County, New York&quot;),
         year %in% c(2010:2016)) %&gt;% 
  select(geoid, county = parent_location) %&gt;% 
  mutate(geoid = as.character(geoid),
         boro = recode(county, &quot;New York County, New York&quot; = &quot;Manhattan&quot;, 
                               &quot;Queens County, New York&quot; = &quot;Queens&quot;, 
                               &quot;Kings County, New York&quot; = &quot;Brooklyn&quot;, 
                               &quot;Bronx County, New York&quot; = &quot;Bronx&quot;, 
                               &quot;Richmond County, New York&quot; = &quot;Staten Island&quot;)) %&gt;% 
  distinct()</code></pre>
<p>Joining datasets</p>
<pre class="r"><code>## all rows regardless of NA, using outer (full) join

joined_data = 
  eviction %&gt;% 
  full_join(., density_data, by = c(&quot;geoid&quot;, &quot;year&quot;)) %&gt;% 
  full_join(., englang_data,  by = c(&quot;geoid&quot;, &quot;year&quot;)) %&gt;% 
  full_join(., race_data,  by = c(&quot;geoid&quot;, &quot;year&quot;)) %&gt;% 
  inner_join(., geoid_boro_key, by = &quot;geoid&quot;) %&gt;% 
  
  mutate(years_since_2010 = as.numeric(year) - 1) %&gt;%  ## continuous year measure range 0-6, years since 2010
  
  ## reordering variables
  
  select(geoid, year, years_since_2010, boro, county, ## geo/time
         evictions, eviction_rate, eviction_filings, eviction_filing_rate, ## outcomes
         pct_nonwhite_racedata, white, black, aian, asian, nhpi, other, hisp, ## race predictors
         rent_burden, pct_eng, density, ## other predictors
         renter_occupied_households, total_pop_densitydata, area_sqmi, ## calculation variables
         poverty_rate, pct_af_am, pct_renter_occupied, median_gross_rent, median_household_income, median_property_value, family_size, pct_fam_households ## contextual predictor variables
         ) 

## just brooklyn
joined_data_bklyn =
  joined_data %&gt;% 
  filter(boro == &quot;Brooklyn&quot;)

joined_data_bklyn %&gt;% 
  saveRDS(file = &#39;./data/joined_data_bklyn&#39;) ## saving to use in other files (use [obj_name] = readRDS([pathway]) )

## all rows with all needed information, no missing
joined_data_bklyn_nomissing =
  joined_data_bklyn %&gt;% 
  drop_na()

joined_data_bklyn_nomissing %&gt;% 
  saveRDS(file = &#39;./data/joined_data_bklyn_nomissing&#39;) ## saving to use in other files (use [obj_name] = readRDS([pathway]) )</code></pre>
</div>
<div id="variables-of-interest" class="section level4">
<h4><em>Variables of interest</em></h4>
<p>NOTE: Eviction rate and eviction filing rate represent the number of evictions or eviction filings divided by the number of renter occupied households and multiplied by 100 to be interpreted as a percentage.</p>
</div>
</div>
<div id="methods" class="section level2">
<h2>Methods</h2>
</div>
<div id="exploratory-analysis" class="section level2">
<h2>Exploratory Analysis</h2>
<div id="mapping" class="section level4">
<h4><em>Mapping</em></h4>
<p>Census tract and neighobrhood shapefiles were downloaded from NYC Open Data and limited to Brooklyn.</p>
<pre class="r"><code># Loading in Brooklyn data
joined_data_bklyn_2010 = 
  readRDS(&#39;./data/joined_data_bklyn&#39;) %&gt;%
  filter(year == &quot;2010&quot;)

# Loading census tract shapefiles from NYC OpenData:
census_tracts = readOGR(dsn = &quot;maps/2010-census-tracts.shp&quot;, encoding = &quot;UTF-8&quot;) 

census_tracts = 
  census_tracts[census_tracts$boro_name == &quot;Brooklyn&quot;, ]

# The following step removes null values from the dataset based on filtering values above
writeOGR(census_tracts,&quot;./mapping_files&quot;,&quot;census_temp&quot;, driver = &quot;ESRI Shapefile&quot;, overwrite_layer = TRUE)
census_tracts = readOGR(&quot;./mapping_files&quot;,&quot;census_temp&quot;)

# Constructing geoid for merging
census_tracts@data = 
  census_tracts@data %&gt;% 
  mutate(
    county_code = as.character(recode(boro_code, &quot;1&quot; = &quot;061&quot;, &quot;2&quot; = &quot;005&quot;, &quot;3&quot; = &quot;047&quot;, &quot;4&quot; = &quot;081&quot;, &quot;5&quot; = &quot;085&quot;)),
    ct2010 = as.character(ct2010),
    fips_11dig = paste0(&quot;36&quot;, county_code, ct2010),
    long = coordinates(spTransform(census_tracts, CRS(&quot;+proj=longlat +datum=WGS84&quot;)))[,1],
    lat = coordinates(spTransform(census_tracts, CRS(&quot;+proj=longlat +datum=WGS84&quot;)))[,2]
    ) %&gt;%
  unnest(c(long, lat))

# Joining data and shapefiles
census_tracts@data = left_join(census_tracts@data, joined_data_bklyn_2010, by = c(&quot;fips_11dig&quot; = &quot;geoid&quot;))

# Create map projection ready for mapping
census_tracts_crs = 
  spTransform(census_tracts, CRS(&quot;+init=epsg:4326&quot;))</code></pre>
<p>In order to inform model building, we created simple visualizations of our four predictors (percentage of ESL speakers, percentage of non-White residents, rent burden, and population density) over a choropleth of eviction rates in Brooklyn by census tract in 2010.</p>
<pre class="r"><code># Sample map code (Eviction rates and % ESL by census tract)
leaflet::leaflet(data = census_tracts_crs) %&gt;% 
  addProviderTiles(&#39;CartoDB.Positron&#39;) %&gt;% 
  addPolygons(
    fillColor = ~eng_palette(pct_eng),
    fillOpacity = 0.8,
    color = &quot;BDBDC3&quot;,
    weight = 1,
    popup = esl_popup,
    highlightOptions = highlightOptions(color = &quot;black&quot;, weight = 2, bringToFront = TRUE)) %&gt;% 
      addLegend(&#39;bottomleft&#39;,
            pal = eng_palette,
            values = ~pct_eng,
            title = &#39;% ESL&#39;,
            opacity = 1) %&gt;%
  addCircleMarkers(
    lat = ~ census_tracts_crs$lat,
    lng = ~ census_tracts_crs$long,
    color = &quot;red&quot;,
    radius = (sqrt(census_tracts_crs$eviction_rate)*2),
    weight = 0
    ) %&gt;%
      addLegendCustom(colors = c(&quot;red&quot;, &quot;red&quot;, &quot;red&quot;), 
        labels = c(&quot;1&quot;, &quot;3&quot;, &quot;8&quot;), sizes = c(4, 6.9282, 11.3137))</code></pre>
<p>The results of our exploratory analyses were used to inform further model building.</p>
</div>
</div>
<div id="additional-analysis" class="section level2">
<h2>Additional Analysis</h2>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
</div>

<html>
  
&nbsp;
<hr />

<small>
  
<p style="text-align: center;">
  Gloria Hu, Naama Kipperman, Will Simmons, Frances Williams
</p>

<p style="text-align: center;">
Visualizations and analyses performed using <a href="https://www.r-project.org/about.html">R</a> (v3.6.1) and <a href="https://rstudio.com">RStudio</a> (v1.2.1335). <br>

Additional interactivity added using <a href="https://plot.ly/">plotly</a> (v4.9.0) and <a href="https://shiny.rstudio.com/">Shiny</a> (v1.3.2). <br>

<a href="https://simmwill.github.io/evictions/packages.html">Click here</a> to see details on all programs used. 

<br>
<br>

2019
</p>

</small>

</html>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
